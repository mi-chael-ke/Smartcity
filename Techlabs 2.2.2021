import matplotlib.pyplot as plt
import numpy as np
import pandas as pd

data = pd.read_excel("Techlabss.xlsx")
x= data.Longitude
y=data.Latitude

# Grid
xgg = np.linspace(min(x), max(x), 10)
ygg = np.linspace(min(y), max(y), 10)
x_1g, y_1g = np.meshgrid(xgg, ygg)
plt.plot(x_1g, y_1g, ".k")
plt.show()

# Matthias Code
def read(path): 
    
    liste = pd.read_excel(path)
    new_list = []
    length = len(liste['Name'].tolist())

    for a in range(length):
        name = liste['Name'].tolist()[a]
        lon = liste['Longitude'].tolist()[a]
        lat = liste['Latitude'].tolist()[a]
        new_list.append([name,lon,lat])
    return new_list

def grid(liste, longitude, latitude):
    
    output=[]

    for part in liste:
        if part[1] > longitude[0] and part[1] < longitude[1]:
            if part[2] > latitude[0] and part [2] < latitude[1]: 
                output.append(part)
    return len(output)
    
liste = read("Techlabss.xlsx")

schools = []

for positionx, elementx in enumerate(xgg[:-1]):
    for positiony, elementy in enumerate(ygg[:-1]):
        print (f"{positionx}_{positiony}")
        print(positionx,elementx, positiony,elementy)
        var = grid(liste, [elementx, xgg[positionx + 1]], [elementy, ygg[positiony + 1]])
        schools.append([elementx, xgg[positionx +1], elementy, ygg[positiony + 1] , var])
        
print(schools)

# data frame creation
df = pd.DataFrame(schools, columns = ["Min Lon", "Max Lon", "Min Lat", "Max Lat", "Number of Schools"])


# heat map (funktioniert nicht)
import folium
from folium.plugins import HeatMap

max_amount = float(df['Number of Schools'].max())
hmap = folium.Map(location=[51.13, 6.7], zoom_start=7)

hm_wide = HeatMap( list(zip(df["Min Lat"].values, df["Min Lon"].values, df["Number of Schools"].values)),
                   min_opacity=0.2,
                   radius=17, blur=15, 
                   max_zoom=1, 
                 )
                 
hmap.add_child(hm_wide)

import os

hmap.save(os.path.join(os.path.join(os.path.expanduser('~')), 'Desktop/heatmap.html') )
